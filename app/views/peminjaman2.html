<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peminjaman</title>
    <script src="/js/cssLinkLoader.js"></script>
    <script src="/js/templateLoader.js"></script>
    <script src="/js/jquery-3.7.1.min.js"></script>
    <style>
        /* Mencegah FOUC */
        body {visibility: hidden;}
        @import url("https://fonts.googleapis.com/css?family=Montserrat:700,400|Inter:700,400");
    </style>
</head>
<body>
    <div id="template-header"></div>
    <div id="heading-container">
        <div id="title-heading">
            <span>Peminjaman Ruangan dan Aset</span>
        </div>
        <hr>
    </div>
    <div id="content-container">
        <div id="filter-container">
            <section>
                <span>Jenis</span>
                <button>
                    <img src="/assets/images/icon/checkmark.png">
                    Ruangan
                </button>
                <button>
                    <img src="/assets/images/icon/checkmark.png">
                    Aset
                </button>
            </section>
            <section>
                <span>Rating</span>
                <button>
                    <img src="/assets/images/icon/checkmark.png">
                    Tertinggi
                </button>
                <button>
                    <img src="/assets/images/icon/checkmark.png">
                    Terendah
                </button>
                <button class="flex-f">
                    <img src="/assets/images/icon/checkmark.png">
                    Paling sering dipinjam
                </button>
            </section>
            <section>
                <span>Lainnya</span>
                <button>
                    <img src="/assets/images/icon/checkmark.png">
                    Ready
                </button>
            </section>
        </div>
        <div id="item-container">
            <div class="item-card">
                <div class="item-img-container"><img src="/assets/images/room.jpg"></div>
                <div class="item-info"><span class="item-name">Auditorium FTTK</span><span class="item-score">4.3 / 5.0</span>
                    <p class="item-description">Ruangan audit dengan 4 AC dan juga Proyektor</p>
                </div>
            </div>
            <div class="item-card">
                <div class="item-img-container"><img src="/assets/images/room.jpg"></div>
                <div class="item-info"><span class="item-name">Lab TI</span><span class="item-score">4.3 / 5.0</span>
                    <p class="item-description">Ruangan laboratorium untuk praktikum </p>
                </div>
            </div>
            <div class="item-card">
                <div class="item-img-container"><img src="/assets/images/room.jpg"></div>
                <div class="item-info"><span class="item-name">Lab TI 2</span><span class="item-score">4.3 / 5.0</span>
                    <p class="item-description">Ruangan laboratorium untuk praktikum </p>
                </div>
            </div>
            <div class="item-card">
                <div class="item-img-container"><img src="/assets/images/room.jpg"></div>
                <div class="item-info"><span class="item-name">Lab TI 3</span><span class="item-score">4.3 / 5.0</span>
                    <p class="item-description">Ruangan laboratorium untuk praktikum </p>
                </div>
            </div>
            <div class="item-card">
                <div class="item-img-container"><img src="/assets/images/room.jpg"></div>
                <div class="item-info"><span class="item-name">Lab TI 4</span><span class="item-score">4.3 / 5.0</span>
                    <p class="item-description">Ruangan laboratorium untuk praktikum</p>
                </div>
            </div>
            <div id="pagination">
                <button class="page-btn">1</button>
                <button class="page-btn">2</button>
                <button class="page-btn">3</button>
                <button class="page-btn">4</button>
                <button class="page-btn">5</button>
            </div>
        </div>
    </div>
    <div id="template-footer"></div>
    <script>
        const template = new Template(['header', 'footer']);
        const container = document.getElementById('item-container');

        loadCSS([
            'main',
            'peminjaman2',
            'template/header',
            'template/footer',
            'font/ubuntu'
        ]);

        function toggleFilter(element) {
            if (!element) {
                console.log("Filter button not found!");
                return;
            }
            element.classList.toggle('active');
        }

        const filterButtons = document.querySelectorAll('#filter-container button');
        filterButtons.forEach((btn) => {
            btn.addEventListener('click', function() {
                toggleFilter(btn);
            });
        });

        $.ajax({
            url: '/api/room',
            method: 'GET'
        })
        .done(function(e, textStatus, xhr) {
            if (!e.data) {
                console.log("Data not found!");
                return;
            }
            container.innerHTML = "";
            e.data.forEach((item)=>{
                console.log(item);
                container.innerHTML += `
                <a class="item-card" href="/peminjaman/${item.req_type?"asset":"ruangan"}?id=${item.room_id ?? item.asset_id}">
                    <div class="item-img-container"><img src="https://separuh.s3.ap-southeast-2.amazonaws.com/${item.room_id ?? item.asset_id}.png?time=${new Date().getHours()}"></div>
                    <div class="item-info"><span class="item-name">${item.room_name ?? item.asset_name}</span><span class="item-score">4.3 / 5.0</span>
                        <p class="item-description">${item.description}</p>
                    </div>
                </a>
                `;
            });
            // template.generateItems(e.data);
        });
    </script>
</body>
</html>